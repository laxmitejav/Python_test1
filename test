import boto3

client = boto3.client('secretsmanager')

file_data = open('secret-names.txt','r')
secrets_with_tags = []
success = open('success.txt','w')
fail = open('fail.txt','w')
for line in file_data:
    try:
        line = line.strip()
        resp = client.describe_secret(SecretId=line)
        if 'Tags' in resp:
            line_output = []
            #line_output.append(line)
            for tag in resp['Tags']:
                if ("SystemOwner" == tag['Key'] or "SystemCustodian" == tag['Key'] or "PrimaryItContact" == tag['Key']):
                    line_output.append(tag['Key'])
                    line_output.append(tag['Value'])
            success.write(line+','+('|'.join(line_output)+"\n"))
    except Exception as e:
        fail.write(line+"\n")
